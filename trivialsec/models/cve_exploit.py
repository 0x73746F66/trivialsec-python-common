from trivialsec.helpers.mysql_adapter import MySQL_Row_Adapter, MySQL_Table_Adapter

__module__ = 'trivialsec.models.cve_exploit'
__table__ = 'cve_exploits'
__pk__ = 'cve_id'

class Exploit(MySQL_Row_Adapter):
    def __init__(self, **kwargs):
        super().__init__(__table__, __pk__)
        self.cve_id = kwargs.get('cve_id')
        self.source = kwargs.get('source')
        self.source_id = kwargs.get('source_id')
        self.source_url = kwargs.get('source_url')
        self.title = kwargs.get('title')
        self.published_at = kwargs.get('published_at')
        self.author = kwargs.get('author')
        self.author_url = kwargs.get('author_url')
        self.verified = bool(kwargs.get('verified'))

    def __setattr__(self, name, value):
        if name in ['verified']:
            value = bool(value)
        super().__setattr__(name, value)

class Exploits(MySQL_Table_Adapter):
    def __init__(self):
        super().__init__('Exploit', __table__, __pk__)
